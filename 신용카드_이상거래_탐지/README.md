# 💳 신용카드 이상거래 탐지 (Credit Card Fraud Detection)

## 📌 프로젝트 개요
- **주제**: 신용카드 거래에서 **사기 가능성**을 예측해 손실을 줄이는 모델 개발  
- **데이터**: Kaggle **Credit Card Fraud Detection** (`creditcard.csv`)  
- **타깃**: `Class` (0=정상, 1=사기) — 전체의 **약 0.17%**만 사기인 **극단적 불균형** 데이터  
- **목적**: 거래별 위험 점수 + **임계값 정책(Threshold)** 으로 *미탐/오탐* 트레이드오프를 관리하여 실무에 적용

---

## 🧭 분석 흐름
1. **타깃 불균형 확인** — 정상/사기 비율 및 건수(사기≈0.17%)  
2. **Train/Test 분할** — `stratify` 층화 분할 (두 세트 모두 사기 비율 유지)  
3. **베이스라인: 로지스틱(가중치)** — `class_weight="balanced"`로 불균형 보정, ROC/PR 곡선  
4. **불균형 보강: SMOTE + 로지스틱** — 학습 세트에서만 오버샘플링 후 성능 비교  
5. **더 강한 모델: 랜덤포레스트** — 비선형/상호작용 학습 + **임계값 탐색(F1 최대)**  
6. **비지도 보조선: Isolation Forest** — 신규 유형 탐지 보완(단독 운영은 비추)  
7. **최종 요약 테이블** — 정밀도/재현율/F1/ROC-AUC/PR-AUC 비교

---

## ⚙️ 전처리 & 모델
- **전처리**: `Amount`, `Time`만 `RobustScaler` (이상치에 강함) / `V1~V28`은 PCA 특성이라 그대로 사용  
- **모델**  
  - 로지스틱(가중치) — 빠른 기준선, 해석 용이  
  - SMOTE+로지스틱 — 학습 세트에서만 합성(누수 방지: 파이프라인)  
  - **랜덤포레스트** — 가장 높은 탐지력, 임계값으로 정책 조정  
  - Isolation Forest — 비지도 보조

---

## 📊 핵심 결과 (실행 기준)
| 모델 | 임계값 | 정밀도 | 재현율 | F1 | ROC-AUC | **PR-AUC** |
|---|---:|---:|---:|---:|---:|---:|
| 로지스틱(가중치) | 0.50 | 0.061 | 0.918 | 0.114 | 0.972 | **0.717** |
| SMOTE+로지스틱 | 0.50 | 0.059 | 0.918 | 0.111 | 0.971 | **0.725** |
| **랜덤포레스트** | 0.50 | **0.862** | **0.827** | **0.844** | **0.978** | **0.847** |
| **랜덤포레스트(F1 최대)** | **0.56** | **0.879** | **0.816** | **0.847** | **0.978** | **0.847** |

> 참고: 랜덤포레스트 혼동행렬(예시)  
> - 임계값 0.50 → `[[56851, 13], [17, 81]]` (FP=13, FN=17)  
> - F1 최대(0.56) → `[[56853, 11], [18, 80]]` (정밀도↑, 재현율↓)

**해석**  
- **PR-AUC** 기준 **랜덤포레스트**가 가장 우수.  
- 임계값을 조정해 **오탐(정밀도)** vs **미탐(재현율)** 을 운영 목적에 맞게 선택 가능.  
- **Isolation Forest**는 정밀도 0.23 / 재현율 0.26 수준 → **보조 탐지라인**으로 활용.

---

## 🧩 실무 적용 포인트
- **임계값 정책**:  
  - *미탐 최소화(재현율 우선)* → 임계값 낮춤(경보↑)  
  - *오탐 최소화(정밀도 우선)* → 임계값 높임(경보↓)  
- **운영 지표**: 경보량, 담당자 처리량, 예상 손실/절감액(비용가중 평가)  
- **거버넌스**: 데이터 누수 점검(사후 정보 금지), 재학습 주기, 드리프트/알림율 모니터링
